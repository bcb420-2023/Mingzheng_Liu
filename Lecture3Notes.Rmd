---
title: "BCB420_Assignment"
author: "Mingzheng liu"
date: "30/01/2022"
output: html_document
editor_options: 
  markdown: 
    wrap: 72
---
 BCB420 Assignment 1 Data Selection and Initial Processing
---
## Overview
* where to find expression data? - Gene Expression Omnibus (GEO)
* tools for mining data - GEOmetadb package
* different platforms available
* how to find a dataset od interest?

## Packages required
Geometadb
* a package that make querying the metadata describing microarray experiments, platforms, and datasets easier. Especially for R users.
* Based on a SQLite database; GEO datatypes including:
** GEO samples (GSM)
** GEO platforms (GPL)
** GEO data series (GSE) curated GEO datasets (GDS)

```{r}
# if (!requireNamespace("BiocManager", quietly = TRUE)) install.packages("BiocManager")
# if (!requireNamespace("GEOmetadb", quietly = TRUE)) BiocManager::install("GEOmetadb")
# if (!requireNamespace("ggplot2", quietly = TRUE)) install.packages("ggplot2")
library(BiocManager)
library(GEOmetadb)
library(ggplot2)
```

### GEOmethdb Set-up
1. get the meta data
2. package download the meta dat not the expression data

```{r}
if(!file.exists('GEOmetadb.sqlite')) getSQLiteFile()
file.info('GEOmetadb.sqlite')

# connect Geo meta data db
con <- dbConnect(SQLite(),'GEOmetadb.sqlite')

# check out the tables available
geo_tables <- dbListTables(con)
geo_tables

# details of an individual table
dbListFields(con,'gse')

# Run SQL queries
results <- dbGetQuery(con,'select * from gpl limit 5')
knitr::kable(head(results[,1:5]), format = "html")
```

### Platforms
How many platforms

```{r}
num_platforms <- dbGetQuery(con,'select count(*) from gpl')
num_platforms

# other infos we can get from GPL table
dbListFields(con,'gpl')

# unique technologies
uniq_tech <- dbGetQuery(con,'select distinct technology from gpl')
nrow(uniq_tech)

# print out the result
knitr::kable(uniq_tech[1:2,], format = "html")

#create table w/ 2 cols so that all data fit on 
mod_table <- cbind(uniq_tech[1:(nrow(uniq_tech)/2), 1],
                   uniq_tech[((nrow(uniq_tech)/2)+1):nrow(uniq_tech), 1])

knitr::kable(mod_table, format = "html")

num_uniq_tech <- dbGetQuery(con,'select technology, count(*) from gpl where organism = "human" group by technology')
colnames(num_uniq_tech)[2] <- "Num_Platforms"
```

* Visualization of data
```{r}
plot_df <- num_uniq_tech[!is.na(num_uniq_tech$technology),]

p<-ggplot(data=plot_df, aes(technology, Num_Platforms)) +
  geom_col() + coord_flip()
p
```

```{r}
uniq_tech_human <- rbind(data.frame(num_uniq_tech_human,
                                    type="human only"),
                         data.frame(num_uniq_tech_contain_human,
                                    type = "contains human"))
# Visualize data.frame
knitr::kable(uniq_tech_human[c(1,2,16,17),], format = "html")
```



### 1. Select an Expression Data Set

### 2. Clean the data and map to HUGO symbols

### 3. Apply Normalization

### 4. Interpret, and document



